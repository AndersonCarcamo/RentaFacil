# ğŸ¨ Diagrama Visual del Sistema de UbicaciÃ³n

## ğŸ“± Interfaz de Usuario - Step 2: UbicaciÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ Paso 2: UbicaciÃ³n                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â„¹ï¸ ğŸ“ UbicaciÃ³n Interactiva                                      â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Selecciona la ubicaciÃ³n en el mapa o completa la direcciÃ³n.     â”‚ â”‚
â”‚  â”‚ Obtendremos automÃ¡ticamente las coordenadas GPS.                â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ âœ“ Coordenadas: -12.119200, -77.028600                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Departamentoâ”‚ Provincia           â”‚ Distrito                    â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [Lima â–¼]    â”‚ [Limâ–®]              â”‚ [Mirâ–®]                      â”‚ â”‚
â”‚  â”‚             â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚             â”‚ â”‚ Lima            â”‚ â”‚ â”‚ Miraflores            â”‚   â”‚ â”‚
â”‚  â”‚             â”‚ â”‚ (hover)         â”‚ â”‚ â”‚ Miramar               â”‚   â”‚ â”‚
â”‚  â”‚             â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ Miramar Alto          â”‚   â”‚ â”‚
â”‚  â”‚             â”‚                     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                        â”‚
â”‚  DirecciÃ³n (opcional)                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Av. JosÃ© Pardo 123, Piso 5                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  ğŸ’¡ La direcciÃ³n exacta solo se mostrarÃ¡ a usuarios interesados       â”‚
â”‚                                                                        â”‚
â”‚  ğŸ“ UbicaciÃ³n en el Mapa                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚         â•”â•â•â•â•â•â•â•â•â•â•â•â•—                                            â”‚ â”‚
â”‚  â”‚         â•‘   MAPA    â•‘     [+ -] ğŸ” Zoom                         â”‚ â”‚
â”‚  â”‚         â•‘           â•‘                                            â”‚ â”‚
â”‚  â”‚         â•‘     ğŸ“    â•‘  â† Marcador arrastrable                   â”‚ â”‚
â”‚  â”‚         â•‘  (Marker) â•‘                                            â”‚ â”‚
â”‚  â”‚         â•‘           â•‘                                            â”‚ â”‚
â”‚  â”‚         â•šâ•â•â•â•â•â•â•â•â•â•â•â•                                            â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚  ğŸŒ OpenStreetMap                                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  ğŸ’¡ Haz clic en el mapa o arrastra el marcador para ajustar           â”‚
â”‚                                                                        â”‚
â”‚  [â† AtrÃ¡s]                                            [Siguiente â†’]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Flujo de InteracciÃ³n

### Escenario 1: SelecciÃ³n Manual con Autocompletado

```
Usuario                    Sistema                      Mapa
   â”‚                          â”‚                          â”‚
   â”‚ 1. Selecciona "Lima"     â”‚                          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
   â”‚                          â”‚ Carga provincias         â”‚
   â”‚                          â”‚ de Lima                  â”‚
   â”‚                          â”‚                          â”‚
   â”‚ 2. Escribe "lim"         â”‚                          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
   â”‚                          â”‚ Filtra opciones          â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Muestra "Lima"           â”‚
   â”‚                          â”‚                          â”‚
   â”‚ 3. Selecciona "Lima"     â”‚                          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
   â”‚                          â”‚ Carga distritos          â”‚
   â”‚                          â”‚ Coordenadas: -12.04,     â”‚
   â”‚                          â”‚              -77.04      â”‚
   â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                          â”‚                          â”‚ Centra en Lima
   â”‚                          â”‚                          â”‚ Zoom nivel 13
   â”‚                          â”‚                          â”‚
   â”‚ 4. Escribe "mira"        â”‚                          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
   â”‚                          â”‚ Filtra distritos         â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ "Miraflores"             â”‚
   â”‚                          â”‚                          â”‚
   â”‚ 5. Selecciona            â”‚                          â”‚
   â”‚    "Miraflores"          â”‚                          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
   â”‚                          â”‚ Coordenadas: -12.11,     â”‚
   â”‚                          â”‚              -77.02      â”‚
   â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                          â”‚                          â”‚ Centra en Miraflores
   â”‚                          â”‚                          â”‚ Zoom nivel 15
   â”‚                          â”‚                          â”‚ ğŸ“ Coloca marcador
   â”‚                          â”‚                          â”‚
   â”‚ 6. Arrastra marcador     â”‚                          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                          â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Nuevas coords
   â”‚                          â”‚ -12.1120, -77.0290       â”‚
   â”‚                          â”‚                          â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ "âœ… UbicaciÃ³n            â”‚
   â”‚ "Actualizada"            â”‚ actualizada"             â”‚
   â”‚                          â”‚                          â”‚
```

### Escenario 2: Uso del Mapa Primero

```
Usuario                    Sistema                      Mapa
   â”‚                          â”‚                          â”‚
   â”‚ 1. Hace zoom en mapa     â”‚                          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                          â”‚                          â”‚ Zoom in/out
   â”‚                          â”‚                          â”‚
   â”‚ 2. Navega por el mapa    â”‚                          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                          â”‚                          â”‚ Pan (desplazar)
   â”‚                          â”‚                          â”‚
   â”‚ 3. Click en ubicaciÃ³n    â”‚                          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                          â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Coords capturadas
   â”‚                          â”‚ lat: -12.0976            â”‚ ğŸ“ Marcador
   â”‚                          â”‚ lng: -77.0363            â”‚
   â”‚                          â”‚                          â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Actualiza formData       â”‚
   â”‚ "âœ… UbicaciÃ³n            â”‚                          â”‚
   â”‚ actualizada"             â”‚                          â”‚
   â”‚                          â”‚                          â”‚
   â”‚ [FUTURO]                 â”‚                          â”‚
   â”‚                          â”‚ Geocoding inverso        â”‚
   â”‚                          â”‚ Detecta: "San Isidro"    â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Autocompleta distrito    â”‚
   â”‚                          â”‚                          â”‚
```

---

## ğŸ§© Arquitectura de Componentes

```
create-listing.tsx (Formulario Principal)
    â”‚
    â”œâ”€â”€â”€ Step 2: UbicaciÃ³n
    â”‚       â”‚
    â”‚       â”œâ”€â”€â”€ <select> Departamento
    â”‚       â”‚       â””â”€â”€â”€ Options: [Lima, Callao]
    â”‚       â”‚
    â”‚       â”œâ”€â”€â”€ <AutocompleteInput> Provincia
    â”‚       â”‚       â”œâ”€â”€â”€ Input con filtrado
    â”‚       â”‚       â”œâ”€â”€â”€ Dropdown dinÃ¡mico
    â”‚       â”‚       â””â”€â”€â”€ onChange â†’ actualiza coords
    â”‚       â”‚
    â”‚       â”œâ”€â”€â”€ <AutocompleteInput> Distrito
    â”‚       â”‚       â”œâ”€â”€â”€ Input con filtrado
    â”‚       â”‚       â”œâ”€â”€â”€ Dropdown dinÃ¡mico
    â”‚       â”‚       â””â”€â”€â”€ onChange â†’ actualiza coords + centra mapa
    â”‚       â”‚
    â”‚       â”œâ”€â”€â”€ <input> DirecciÃ³n
    â”‚       â”‚       â””â”€â”€â”€ onChange â†’ geocoding (1s debounce)
    â”‚       â”‚
    â”‚       â””â”€â”€â”€ <MapPicker> (dynamic import)
    â”‚               â”œâ”€â”€â”€ Leaflet Map
    â”‚               â”œâ”€â”€â”€ Draggable Marker
    â”‚               â”œâ”€â”€â”€ Click Handler
    â”‚               â””â”€â”€â”€ onLocationChange â†’ actualiza coords
    â”‚
    â””â”€â”€â”€ FormData State
            â”œâ”€â”€â”€ department: string
            â”œâ”€â”€â”€ province: string
            â”œâ”€â”€â”€ district: string
            â”œâ”€â”€â”€ address: string
            â”œâ”€â”€â”€ latitude: number | null
            â””â”€â”€â”€ longitude: number | null
```

---

## ğŸ—‚ï¸ Estructura de Datos

```
PERU_LOCATIONS
    â”‚
    â”œâ”€â”€â”€ Lima (Department)
    â”‚       â”‚
    â”‚       â”œâ”€â”€â”€ Lima (Province)
    â”‚       â”‚       â”œâ”€â”€â”€ coordinates: { lat: -12.0464, lng: -77.0428 }
    â”‚       â”‚       â””â”€â”€â”€ districts: [
    â”‚       â”‚               {
    â”‚       â”‚                   name: "Miraflores",
    â”‚       â”‚                   coordinates: { lat: -12.1192, lng: -77.0286 }
    â”‚       â”‚               },
    â”‚       â”‚               {
    â”‚       â”‚                   name: "San Isidro",
    â”‚       â”‚                   coordinates: { lat: -12.0976, lng: -77.0363 }
    â”‚       â”‚               },
    â”‚       â”‚               ... (43 distritos)
    â”‚       â”‚           ]
    â”‚       â”‚
    â”‚       â”œâ”€â”€â”€ Barranca (Province)
    â”‚       â”‚       â””â”€â”€â”€ districts: [ ... 5 distritos ]
    â”‚       â”‚
    â”‚       â”œâ”€â”€â”€ CaÃ±ete (Province)
    â”‚       â”‚       â””â”€â”€â”€ districts: [ ... 11 distritos ]
    â”‚       â”‚
    â”‚       â””â”€â”€â”€ ... (10 provincias total)
    â”‚
    â””â”€â”€â”€ Callao (Department)
            â””â”€â”€â”€ Callao (Province)
                    â”œâ”€â”€â”€ coordinates: { lat: -12.0565, lng: -77.1181 }
                    â””â”€â”€â”€ districts: [
                            "Callao", "Bellavista", "La Perla",
                            "La Punta", "Ventanilla", "Mi PerÃº",
                            "Carmen de la Legua Reynoso"
                        ]

Total: 2 departamentos, 11 provincias, 173 distritos
```

---

## ğŸ”€ Estado del Formulario (FormData)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          FormData State                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  UbicaciÃ³n Textual:                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ department:  "Lima"                     â”‚   â”‚
â”‚  â”‚ province:    "Lima"                     â”‚   â”‚
â”‚  â”‚ district:    "Miraflores"               â”‚   â”‚
â”‚  â”‚ address:     "Av. JosÃ© Pardo 123"       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚  Coordenadas GPS:                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ latitude:    -12.119200                 â”‚   â”‚
â”‚  â”‚ longitude:   -77.028600                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚  Estado UI:                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ geocodingStatus: "âœ… UbicaciÃ³n          â”‚   â”‚
â”‚  â”‚                   encontrada"           â”‚   â”‚
â”‚  â”‚ geocoding:       false                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¡ Payload de API

```json
POST /api/v1/listings
{
  "title": "Hermoso Departamento en Miraflores",
  "description": "...",
  "operation": "rent",
  "property_type": "apartment",
  
  // UbicaciÃ³n Textual
  "department": "Lima",
  "province": "Lima",
  "district": "Miraflores",
  "address": "Av. JosÃ© Pardo 123, Piso 5",
  
  // Coordenadas GPS (NUEVAS)
  "latitude": -12.119200,
  "longitude": -77.028600,
  
  // ... otros campos ...
  "price": 2500.00,
  "bedrooms": 2,
  "bathrooms": 2
}
```

---

## ğŸ¯ Casos de Uso Visualizados

### Caso 1: Propiedad en Zona Conocida

```
Input:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Departamento: Lima          â”‚
â”‚ Provincia:    Lima          â”‚
â”‚ Distrito:     San Isidro    â”‚
â”‚ DirecciÃ³n:    Av. RepÃºbl... â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Proceso:
1. Autocompletado: "San Isidro" â†’ coords distrito
2. Geocoding: "Av. RepÃºblica..." â†’ coords exactas
3. Mapa: Usuario ajusta marcador

Output:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Lat:  -12.097600            â”‚
â”‚ Lng:  -77.036300            â”‚
â”‚ PrecisiÃ³n: Â± 10 metros      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Caso 2: Usuario No Sabe Distrito

```
Input:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Departamento: Lima          â”‚
â”‚ Provincia:    Lima          â”‚
â”‚ Distrito:     (vacÃ­o)       â”‚
â”‚ [Usuario usa MAPA]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Proceso:
1. Usuario hace zoom en mapa
2. Usuario navega visualmente
3. Usuario hace clic en ubicaciÃ³n
4. Sistema captura coordenadas

Output:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Lat:  -12.120000            â”‚
â”‚ Lng:  -77.030000            â”‚
â”‚ Distrito: (autodetectar*)   â”‚
â”‚ *futuro: geocoding inverso  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Caso 3: Ajuste Fino de UbicaciÃ³n

```
Distrito seleccionado:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "Miraflores"                â”‚
â”‚ Centro aprox: -12.119, -77.028â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
Mapa se centra automÃ¡ticamente
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      [Mapa Visual]          â”‚
â”‚                             â”‚
â”‚         ğŸ“ â† Centro         â”‚
â”‚                             â”‚
â”‚  Usuario arrastra a:        â”‚
â”‚  Su edificio especÃ­fico     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
Coordenadas actualizadas:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ANTES: -12.119200, -77.028600â”‚
â”‚ DESPUÃ‰S:-12.119500, -77.029100â”‚
â”‚ Î”: 50 metros al sureste     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Mapa Conceptual de Lima

```
                        CALLAO
                    (7 distritos)
                    â”‚
                    â”‚  Ventanilla
                    â”‚  â”‚
                    â”‚  â”œâ”€ Callao Centro
                    â”‚  â”œâ”€ Bellavista
                    â”‚  â””â”€ La Punta
                    â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                    â”‚
                 LIMA NORTE
            (Comas, Los Olivos,
         San MartÃ­n de Porres, etc.)
                    â”‚
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                    â”‚
    LIMA OESTE      â”‚      LIMA ESTE
  (San Miguel,      â”‚   (Ate, La Molina,
   Magdalena)       â”‚    SJL, etc.)
                    â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                   â”‚
    LIMA CENTRO         LIMA MODERNA
   (Cercado Lima,      (Miraflores,
    La Victoria,        San Isidro,
    BreÃ±a, etc.)        San Borja,
                        Surco, etc.)
          â”‚                   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                 LIMA SUR
          (Villa El Salvador,
           Chorrillos, LurÃ­n,
           SJM, etc.)
```

---

## ğŸ§­ Coordenadas de Referencia

```
                      N (Norte)
                        â†‘
                        â”‚
                   -11.8 (Ventanilla)
                        â”‚
                        â”‚
W (Oeste) -77.2 â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€ -76.9 E (Este)
   (Callao)             â”‚        (La Molina)
                        â”‚
                        â”‚
                   -12.2 (LurÃ­n)
                        â”‚
                        â†“
                      S (Sur)

Rangos de PerÃº:
- Latitud:  -0Â° (Tumbes) a -18Â° (Tacna)
- Longitud: -68Â° (Madre de Dios) a -81Â° (Piura)

Lima Metropolitana:
- Latitud:  -11.7Â° (norte) a -12.5Â° (sur)
- Longitud: -77.2Â° (oeste) a -76.7Â° (este)
```

---

## ğŸ”„ SincronizaciÃ³n de Estados

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                    â”‚
â”‚   [Distrito Selector] â†â”€â”€â”€â”€â”€â”€â†’ [FormData] â†â”€â”€â”€â”€â”€â”€â†’ [Mapa]
â”‚         â”‚                          â”‚                  â”‚
â”‚         â”‚ onChange                 â”‚ useEffect        â”‚
â”‚         â”‚                          â”‚                  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                          â”‚
â”‚                    Coordenadas
â”‚                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â”‚                                 â”‚
â”‚   [Geocoding API]              [Marcador Arrastrable]
â”‚         â”‚                                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                          â”‚
â”‚                    ActualizaciÃ³n
â”‚                          â”‚
â”‚                          â–¼
â”‚                 [Base de Datos]
â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Leyenda**:
- `â†â”€â”€â”€â”€â†’` : SincronizaciÃ³n bidireccional
- `â”‚` : Flujo unidireccional
- `[Componente]` : Elemento de UI o servicio

---

## ğŸ¨ Estados de la UI

### Estado 1: Inicial (Sin Departamento)
```
Departamento: [ Seleccionar... â–¼ ]
Provincia:    [ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ] (disabled)
Distrito:     [ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ] (disabled)
Mapa:         [Centro de PerÃº, zoom 6]
```

### Estado 2: Departamento Seleccionado
```
Departamento: [ Lima â–¼ ]
Provincia:    [ Escribe o selecciona... ]  (enabled)
Distrito:     [ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ] (disabled)
Mapa:         [Centro de Lima, zoom 10]
```

### Estado 3: Provincia Seleccionada
```
Departamento: [ Lima â–¼ ]
Provincia:    [ Lima ]
Distrito:     [ Escribe o selecciona... ]  (enabled)
Mapa:         [Centro de Provincia Lima, zoom 12]
```

### Estado 4: Distrito Seleccionado + Marcador
```
Departamento: [ Lima â–¼ ]
Provincia:    [ Lima ]
Distrito:     [ Miraflores ]
Mapa:         [ğŸ“ Miraflores, zoom 15]
              âœ“ Coordenadas: -12.119200, -77.028600
```

### Estado 5: Ajuste Manual en Mapa
```
Departamento: [ Lima â–¼ ]
Provincia:    [ Lima ]
Distrito:     [ Miraflores ]
Mapa:         [ğŸ“ PosiciÃ³n ajustada, zoom 17]
              âœ“ Coordenadas: -12.119500, -77.029100
              âœ… UbicaciÃ³n actualizada manualmente
```

---

**Documento de Referencia Visual**  
Creado: 17 de octubre, 2025  
VersiÃ³n: 1.0
